(function(){GoogleFormNotifier={VERSION:"0.9.0",_htmlTemplate:void 0,_textTemplate:void 0,notify:function(a,b){if(a.namedValues===void 0)throw"GoogleFormNotifier: You must check the 'Automatically collect respondent's username' on the form";var c=a.namedValues.Username.toString(),d=this._getRecipients(),e=this._getSubject(),f=this._render(this._transformNamedValues(a.namedValues),this.htmlTemplate()),g=this._render(this._transformNamedValues(a.namedValues),this.textTemplate());b===void 0&&(b={bcc:d.join(","),
replyTo:c,htmlBody:f});MailApp.sendEmail(c,e,g,b)},htmlTemplate:function(a){if(a===void 0){if(this._htmlTemplate===void 0)this._htmlTemplate="<h1>"+this._getSubject()+'</h1><hr />{{#formData}}<h2 style="font-size:12px;margin:20px 0 5px 0;">{{column}}</h2><p style="padding:4px;border:1px solid #ccc;background:#e9e9e9;color:#333;">{{value}}</p>{{/formData}}'}else this._htmlTemplate=a;return this._htmlTemplate},textTemplate:function(a){if(a===void 0){if(this._textTemplate===void 0)this._textTemplate=
this._getSubject()+"\n\n{{#formData}}{{column}}:{{value}}\n\n{{/formData}}"}else this._textTemplate=a;return this._textTemplate},_transformNamedValues:function(a){var b=[],c=0;for(prop in a)a.hasOwnProperty(prop)&&c++;c=SpreadsheetApp.getActiveSpreadsheet().getSheets()[0].getRange(1,1,1,c).getValues();for(i in c[0])b.push({column:c[0][i],value:a[c[0][i]]});return{formData:b}},_getRecipients:function(a){a===void 0&&(a="Notification list");var a=SpreadsheetApp.getActiveSpreadsheet().getSheetByName(a).getDataRange().getValues(),
b=[];for(i=1;i<a.length;i++)b.push(a[i][0]);return b},_getSubject:function(){var a=SpreadsheetApp.getActiveSpreadsheet().getName(),b="A";RegExp(/^[aeiouy]/i).test(a)&&(b="An");return b+" '"+a+"' form has been submitted"},_render:function(a,b){return Handlebars.compile(b)(a)}}})();
